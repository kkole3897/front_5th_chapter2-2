import{j as e,g as $,a as F,c as E,r as g,b as M,R}from"./cart-b_q57JV7.js";const B=({product:t,remainingStock:l,footer:d})=>e.jsxs("div",{"data-testid":`product-${t.id}`,className:"bg-white p-3 rounded shadow",children:[e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsx("span",{className:"font-semibold",children:t.name}),e.jsxs("span",{className:"text-gray-600",children:[t.price.toLocaleString(),"원"]})]}),e.jsxs("div",{className:"text-sm text-gray-500 mb-2",children:[e.jsxs("span",{className:`font-medium ${l>0?"text-green-600":"text-red-600"}`,children:["재고: ",l,"개"]}),t.discounts.length>0&&e.jsxs("span",{className:"ml-2 font-medium text-blue-600",children:["최대 ",($(t.discounts)*100).toFixed(0),"% 할인"]})]}),t.discounts.length>0&&e.jsx("ul",{className:"list-disc list-inside text-sm text-gray-500 mb-2",children:t.discounts.map((r,h)=>e.jsxs("li",{children:[r.quantity,"개 이상: ",(r.rate*100).toFixed(0),"% 할인"]},h))}),d]},t.id),L=({coupon:t})=>e.jsxs("p",{className:"text-green-600",children:["적용된 쿠폰: ",t.name,"(",t.discountType==="amount"?`${t.discountValue}원`:`${t.discountValue}%`," ","할인)"]}),U=({remainingStock:t,onClick:l})=>e.jsx("button",{onClick:l,className:`w-full px-3 py-1 rounded ${t>0?"bg-blue-500 text-white hover:bg-blue-600":"bg-gray-300 text-gray-500 cursor-not-allowed"}`,disabled:t<=0,children:t>0?"장바구니에 추가":"품절"}),O=({item:t,onChangeQuantity:l,onRemove:d})=>{const r=F(t);return e.jsxs("div",{className:"flex justify-between items-center bg-white p-3 rounded shadow",children:[e.jsxs("div",{children:[e.jsx("span",{className:"font-semibold",children:t.product.name}),e.jsx("br",{}),e.jsxs("span",{className:"text-sm text-gray-600",children:[t.product.price,"원 x ",t.quantity,r>0&&e.jsxs("span",{className:"text-green-600 ml-1",children:["(",(r*100).toFixed(0),"% 할인 적용)"]})]})]}),e.jsxs("div",{children:[e.jsx("button",{onClick:()=>l==null?void 0:l(t.product.id,t.quantity-1),className:"bg-gray-300 text-gray-800 px-2 py-1 rounded mr-1 hover:bg-gray-400",children:"-"}),e.jsx("button",{onClick:()=>l==null?void 0:l(t.product.id,t.quantity+1),className:"bg-gray-300 text-gray-800 px-2 py-1 rounded mr-1 hover:bg-gray-400",children:"+"}),e.jsx("button",{onClick:()=>d==null?void 0:d(t.product.id),className:"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",children:"삭제"})]})]})},W=({cart:t,selectedCoupon:l})=>{const{totalBeforeDiscount:d,totalAfterDiscount:r,totalDiscount:h}=E(t,l);return e.jsxs("div",{className:"mt-6 bg-white p-4 rounded shadow",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"주문 요약"}),e.jsxs("div",{className:"space-y-1",children:[e.jsxs("p",{children:["상품 금액: ",d.toLocaleString(),"원"]}),e.jsxs("p",{className:"text-green-600",children:["할인 금액: ",h.toLocaleString(),"원"]}),e.jsxs("p",{className:"text-xl font-bold",children:["최종 결제 금액: ",r.toLocaleString(),"원"]})]})]})},_=({coupons:t,onChange:l})=>e.jsxs("select",{onChange:d=>l(t[parseInt(d.target.value)]),className:"w-full p-2 border rounded mb-2",children:[e.jsx("option",{value:"",children:"쿠폰 선택"}),t.map((d,r)=>e.jsxs("option",{value:r,children:[d.name," -"," ",d.discountType==="amount"?`${d.discountValue}원`:`${d.discountValue}%`]},d.code))]}),z=({products:t,coupons:l})=>{const[d,r]=g.useState([]),[h,y]=g.useState(null),f=a=>{m(a)<=0||r(p=>p.find(u=>u.product.id===a.id)?p.map(u=>u.product.id===a.id?{...u,quantity:Math.min(u.quantity+1,a.stock)}:u):[...p,{product:a,quantity:1}])},c=a=>{r(o=>o.filter(p=>p.product.id!==a))},b=(a,o)=>{r(p=>p.map(N=>{if(N.product.id===a){const u=N.product.stock,v=Math.max(0,Math.min(o,u));return v>0?{...N,quantity:v}:null}return N}).filter(N=>N!==null))},m=a=>{const o=d.find(p=>p.product.id===a.id);return a.stock-((o==null?void 0:o.quantity)||0)},j=a=>{y(a)};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"장바구니"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"상품 목록"}),e.jsx("div",{className:"space-y-2",children:t.map(a=>{const o=m(a);return e.jsx(B,{product:a,remainingStock:o,footer:e.jsx(U,{remainingStock:o,onClick:()=>f(a)})},a.id)})})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"장바구니 내역"}),e.jsx("div",{className:"space-y-2",children:d.map(a=>e.jsx(O,{item:a,onChangeQuantity:b,onRemove:c},a.product.id))}),e.jsxs("div",{className:"mt-6 bg-white p-4 rounded shadow",children:[e.jsx("h2",{className:"text-2xl font-semibold mb-2",children:"쿠폰 적용"}),e.jsx(_,{coupons:l,onChange:j}),h&&e.jsx(L,{coupon:h})]}),e.jsx(W,{cart:d,selectedCoupon:h})]})]})]})},G=({products:t,coupons:l,onProductUpdate:d,onProductAdd:r,onCouponAdd:h})=>{const[y,f]=g.useState(new Set),[c,b]=g.useState(null),[m,j]=g.useState({quantity:0,rate:0}),[a,o]=g.useState({name:"",code:"",discountType:"percentage",discountValue:0}),[p,N]=g.useState(!1),[u,v]=g.useState({name:"",price:0,stock:0,discounts:[]}),w=s=>{f(i=>{const n=new Set(i);return n.has(s)?n.delete(s):n.add(s),n})},C=s=>{b({...s})},k=(s,i)=>{if(c&&c.id===s){const n={...c,name:i};b(n)}},S=(s,i)=>{if(c&&c.id===s){const n={...c,price:i};b(n)}},P=()=>{c&&(d(c),b(null))},q=(s,i)=>{const n=t.find(x=>x.id===s);if(n){const x={...n,stock:i};d(x),b(x)}},A=s=>{const i=t.find(n=>n.id===s);if(i&&c){const n={...i,discounts:[...i.discounts,m]};d(n),b(n),j({quantity:0,rate:0})}},I=(s,i)=>{const n=t.find(x=>x.id===s);if(n){const x={...n,discounts:n.discounts.filter((X,V)=>V!==i)};d(x),b(x)}},T=()=>{h(a),o({name:"",code:"",discountType:"percentage",discountValue:0})},D=()=>{const s={...u,id:Date.now().toString()};r(s),v({name:"",price:0,stock:0,discounts:[]}),N(!1)};return e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("h1",{className:"text-3xl font-bold mb-6",children:"관리자 페이지"}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"상품 관리"}),e.jsx("button",{onClick:()=>N(!p),className:"bg-green-500 text-white px-4 py-2 rounded mb-4 hover:bg-green-600",children:p?"취소":"새 상품 추가"}),p&&e.jsxs("div",{className:"bg-white p-4 rounded shadow mb-4",children:[e.jsx("h3",{className:"text-xl font-semibold mb-2",children:"새 상품 추가"}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"productName",className:"block text-sm font-medium text-gray-700",children:"상품명"}),e.jsx("input",{id:"productName",type:"text",value:u.name,onChange:s=>v({...u,name:s.target.value}),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"productPrice",className:"block text-sm font-medium text-gray-700",children:"가격"}),e.jsx("input",{id:"productPrice",type:"number",value:u.price,onChange:s=>v({...u,price:parseInt(s.target.value)}),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"mb-2",children:[e.jsx("label",{htmlFor:"productStock",className:"block text-sm font-medium text-gray-700",children:"재고"}),e.jsx("input",{id:"productStock",type:"number",value:u.stock,onChange:s=>v({...u,stock:parseInt(s.target.value)}),className:"w-full p-2 border rounded"})]}),e.jsx("button",{onClick:D,className:"w-full bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:"추가"})]}),e.jsx("div",{className:"space-y-2",children:t.map((s,i)=>e.jsxs("div",{"data-testid":`product-${i+1}`,className:"bg-white p-4 rounded shadow",children:[e.jsxs("button",{"data-testid":"toggle-button",onClick:()=>w(s.id),className:"w-full text-left font-semibold",children:[s.name," - ",s.price,"원 (재고: ",s.stock,")"]}),y.has(s.id)&&e.jsx("div",{className:"mt-2",children:c&&c.id===s.id?e.jsxs("div",{children:[e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"상품명: "}),e.jsx("input",{type:"text",value:c.name,onChange:n=>k(s.id,n.target.value),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"가격: "}),e.jsx("input",{type:"number",value:c.price,onChange:n=>S(s.id,parseInt(n.target.value)),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{className:"mb-4",children:[e.jsx("label",{className:"block mb-1",children:"재고: "}),e.jsx("input",{type:"number",value:c.stock,onChange:n=>q(s.id,parseInt(n.target.value)),className:"w-full p-2 border rounded"})]}),e.jsxs("div",{children:[e.jsx("h4",{className:"text-lg font-semibold mb-2",children:"할인 정보"}),c.discounts.map((n,x)=>e.jsxs("div",{className:"flex justify-between items-center mb-2",children:[e.jsxs("span",{children:[n.quantity,"개 이상 구매 시"," ",n.rate*100,"% 할인"]}),e.jsx("button",{onClick:()=>I(s.id,x),className:"bg-red-500 text-white px-2 py-1 rounded hover:bg-red-600",children:"삭제"})]},x)),e.jsxs("div",{className:"flex space-x-2",children:[e.jsx("input",{type:"number",placeholder:"수량",value:m.quantity,onChange:n=>j({...m,quantity:parseInt(n.target.value)}),className:"w-1/3 p-2 border rounded"}),e.jsx("input",{type:"number",placeholder:"할인율 (%)",value:m.rate*100,onChange:n=>j({...m,rate:parseInt(n.target.value)/100}),className:"w-1/3 p-2 border rounded"}),e.jsx("button",{onClick:()=>A(s.id),className:"w-1/3 bg-blue-500 text-white p-2 rounded hover:bg-blue-600",children:"할인 추가"})]})]}),e.jsx("button",{onClick:P,className:"bg-green-500 text-white px-2 py-1 rounded hover:bg-green-600 mt-2",children:"수정 완료"})]}):e.jsxs("div",{children:[s.discounts.map((n,x)=>e.jsx("div",{className:"mb-2",children:e.jsxs("span",{children:[n.quantity,"개 이상 구매 시"," ",n.rate*100,"% 할인"]})},x)),e.jsx("button",{"data-testid":"modify-button",onClick:()=>C(s),className:"bg-blue-500 text-white px-2 py-1 rounded hover:bg-blue-600 mt-2",children:"수정"})]})})]},s.id))})]}),e.jsxs("div",{children:[e.jsx("h2",{className:"text-2xl font-semibold mb-4",children:"쿠폰 관리"}),e.jsxs("div",{className:"bg-white p-4 rounded shadow",children:[e.jsxs("div",{className:"space-y-2 mb-4",children:[e.jsx("input",{type:"text",placeholder:"쿠폰 이름",value:a.name,onChange:s=>o({...a,name:s.target.value}),className:"w-full p-2 border rounded"}),e.jsx("input",{type:"text",placeholder:"쿠폰 코드",value:a.code,onChange:s=>o({...a,code:s.target.value}),className:"w-full p-2 border rounded"}),e.jsxs("div",{className:"flex gap-2",children:[e.jsxs("select",{value:a.discountType,onChange:s=>o({...a,discountType:s.target.value}),className:"w-full p-2 border rounded",children:[e.jsx("option",{value:"amount",children:"금액(원)"}),e.jsx("option",{value:"percentage",children:"할인율(%)"})]}),e.jsx("input",{type:"number",placeholder:"할인 값",value:a.discountValue,onChange:s=>o({...a,discountValue:parseInt(s.target.value)}),className:"w-full p-2 border rounded"})]}),e.jsx("button",{onClick:T,className:"w-full bg-green-500 text-white p-2 rounded hover:bg-green-600",children:"쿠폰 추가"})]}),e.jsxs("div",{children:[e.jsx("h3",{className:"text-lg font-semibold mb-2",children:"현재 쿠폰 목록"}),e.jsx("div",{className:"space-y-2",children:l.map((s,i)=>e.jsxs("div",{"data-testid":`coupon-${i+1}`,className:"bg-gray-100 p-2 rounded",children:[s.name," (",s.code,"):",s.discountType==="amount"?`${s.discountValue}원`:`${s.discountValue}%`," ","할인"]},i))})]})]})]})]})]})},H=[{id:"p1",name:"상품1",price:1e4,stock:20,discounts:[{quantity:10,rate:.1},{quantity:20,rate:.2}]},{id:"p2",name:"상품2",price:2e4,stock:20,discounts:[{quantity:10,rate:.15}]},{id:"p3",name:"상품3",price:3e4,stock:20,discounts:[{quantity:10,rate:.2}]}],J=[{name:"5000원 할인 쿠폰",code:"AMOUNT5000",discountType:"amount",discountValue:5e3},{name:"10% 할인 쿠폰",code:"PERCENT10",discountType:"percentage",discountValue:10}],K=()=>{const[t,l]=g.useState(H),[d,r]=g.useState(J),[h,y]=g.useState(!1),f=m=>{l(j=>j.map(a=>a.id===m.id?m:a))},c=m=>{l(j=>[...j,m])},b=m=>{r(j=>[...j,m])};return e.jsxs("div",{className:"min-h-screen bg-gray-100",children:[e.jsx("nav",{className:"bg-blue-600 text-white p-4",children:e.jsxs("div",{className:"container mx-auto flex justify-between items-center",children:[e.jsx("h1",{className:"text-2xl font-bold",children:"쇼핑몰 관리 시스템"}),e.jsx("button",{onClick:()=>y(!h),className:"bg-white text-blue-600 px-4 py-2 rounded hover:bg-blue-100",children:h?"장바구니 페이지로":"관리자 페이지로"})]})}),e.jsx("main",{className:"container mx-auto mt-6",children:h?e.jsx(G,{products:t,coupons:d,onProductUpdate:f,onProductAdd:c,onCouponAdd:b}):e.jsx(z,{products:t,coupons:d})})]})};M.createRoot(document.getElementById("root")).render(e.jsx(R.StrictMode,{children:e.jsx(K,{})}));
